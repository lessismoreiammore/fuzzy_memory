<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>what is a hipster, man? web-tutorial for complete beginners</title>
  <link href="https://fonts.googleapis.com/css?family=Oswald:400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="style.css" media="screen">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>

<body>
  <div class="main">
    <div class="container">
      <h1>Who is a hipster, man?</h1>
      <p>web-tutorial for complete beginners
      </p>
      <a href="#" class="btn">Scroll the page to start ▽</a>
    </div>
  </div>

  <div class="supporting">
    <div class="container">
      <h2>What are the first words which came to your mind when somebody says "hipster?"</h2>
      <div class="col">
        <img src="images/hot-drinks.svg" alt="coffee" />
        <p>99% of blood is coffee</p>
      </div>
      <div class="col">
        <img src="images/cycling.svg" alt="bike" />
        <p>cycling all the weather</p>
      </div>
      <div class="col">
        <img src="images/hipster-2.svg" alt="" />
        <p>Movember is every month</p>
      </div>

      <div class="clearfix"></div>
    </div>
  </div>

  <div class="feature">
    <div class="container">
      <h2>Come on, these are just stereotypes, man! </h2>
      <p>For deepen your knowledge, please, check our video</p>
      <iframe width="640" height="360" src="https://www.youtube.com/embed/jbTI7eWaQbk" frameborder="0" allowfullscreen></iframe>
    </div>
  </div>

  <div class="supporting">
    <div class="container">
      <h3>Are you sure you get it?</h3>
      <p>Play the game below! It is a simple memory game</p>
      <a href="#" class="btn">Scroll the page to start game▽</a>
    </div>
  </div>

  <div class="footer">
    <div class="container">

      <div id="result">
        <h2 id="message">What is your hipster score?</h2>
      </div>

      <div class="wrap">

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

        <div class="contain">
          <div class="front card"></div>
          <div class="back card"></div>
        </div>

      </div>

      <a class="btn" id="shuffle">Play again ↻</a>

    </div>

  </div>

  <script>
    //HELPER FUNCTIONS

    //get random number in range between 0 to range - 1
    function random(range) {
      return Math.floor(Math.random() * range);
    }

    //returns random 0 or 1, false or true
    function randomise() {
      return random(2);
    }

    // GAME SETUP
    var tile_array = [];

    function gameSetUp() {
      //this counter is used for making a game raiting, see its explanation under the game logic section of script
      //it gains null value here so that after reshuffle the user can have a new raiting
      counter = 0;
      var heading = document.getElementById('message');
      heading.textContent = "What is your hipster score?";

      //Clean a tile class of each back, need for reshuffle when the function is laucnhed 2nd or more time to delete a hipster class
      // $(".back").each(function(i) {
      //   $(this).removeClass(tile_array[i]);
      // });

      var back = document.querySelectorAll('.back');
      for (let i = 0; i < back.length; i++) {
        back[i].classList.remove(tile_array[i]);
      }


      //array of class names
      var hipster_array = [
        "hipster-1",
        "hipster-2",
        "hipster-3",
        "hipster-4",
        "hipster-5",
        "hipster-6",
        "hipster-7",
        "hipster-8"
      ];

      // Make a copy of person_array, since the next few operations will modify the array
      // If there is no copy after the button reshuffle is pressed nothing will be displayed as cards since the array has been modified by the first run of the program
      var temp_array = hipster_array.slice(0);

      //An array for the tiles to create
      //this array will hold an array of random classes for tiles
      tile_array = [];
      //this array is used to set the number of pairs
      var tile_pairs = 8;

      //Loop through all of the tiles and make a new array of pairs by assigning a random hipster class to the empty array
      for (let i = 0; i < tile_pairs; i++) {
        let r = random(temp_array.length);
        //Add the random hipster class twice since we need a pair for a memory game
        let tile = temp_array.splice(r, 1);
        tile_array = tile_array.concat(tile);
        tile_array = tile_array.concat(tile);
      }

      //shuffle the array with hipster classes
      tile_array.sort(randomise);
      console.log(tile_array);

      //part for reshuffle when the program is launched 2nd or more time to delete classes flip and lock
      $(".contain").each(function() {
        $(this).removeClass("flip");
        $(this).removeClass("lock");
      });

      //Assign a tile class to each back
      $(".back").each(function(i) {
        $(this).addClass(tile_array[i]);
        $(this).parent().attr("data-name", tile_array[i]);
      });

      var deletedChild = document.getElementById('deleted');
      if (typeof(deletedChild) != 'undefined' && deletedChild != null) {
        var sorrowParent = document.getElementById('result');
        sorrowParent.removeChild(deletedChild);
      }
    }

    //GAME LOGIC
    var firstChoice = undefined;
    var secondChoice = undefined;
    //variable to save the number of clicks which will be used
    var counter = 0;
    //variable which store the game ouput
    var output = " ";
    // user raiting check
    function counterCheck(i) {
      if (i <= 16) {
        output = "You are super hipster, dude!!!";
      } else if ((i > 16) && (i < 24)) {
        output = "Do you feel how your beard starts growing? You are doing well, dude!";
      } else {
        output = "Hm...You will not survive in this hipster world! Watch the video again, dude!";
      }
    }

    function userOutput(j, i) {
      let newH = document.getElementById('message');
      newH.textContent = "Your hipster score is " + j;
      let newP = document.createElement('p');
      newP.id = "deleted";
      newP.textContent = i;
      document.getElementById('result').appendChild(newP);
    }

    $(".contain").click(function() {
      if ($(this).hasClass("flip") || $(this).hasClass("lock")) {
        return;
      }

      $(this).addClass("flip");

      if (firstChoice === undefined) {
        firstChoice = $(this);
      } else {
        secondChoice = $(this);
        if (firstChoice.attr("data-name") === secondChoice.attr("data-name")) {
          console.log("Match!");
          counter++;
          firstChoice.addClass("lock");
          secondChoice.addClass("lock");
          if (document.querySelectorAll('.lock').length === 16) {
            counterCheck(counter);
            userOutput(counter, output);
          }
        } else {
          console.log("No match");
          counter++;
          let a = firstChoice;
          let b = secondChoice;
          setTimeout(function() {
            a.removeClass("flip");
            b.removeClass("flip");
          }, 1000);
        }

        //testing line for debugging
        console.log(counter);

        firstChoice = undefined;
        secondChoice = undefined;
      }
    });

    //GAME FLOW

    //calling a function to prepare the game board
    gameSetUp();

    //shuffle when one round of the game ends
    var button = document.getElementById('shuffle');
    button.onclick = gameSetUp;
  </script>
</body>

</html>
